#!/usr/bin/env python

import curses



def main(stdscr):
    curses.curs_set(0)

    CURSOR = "X"
    WINDOW_HEIGHT = curses.LINES - 6
    WINDOW_WIDTH = curses.COLS - 4
    WINDOW_Y = 3
    WINDOW_X = 2

    if curses.has_colors():
        curses.start_color()

    curses.init_pair(1, curses.COLOR_RED, curses.COLOR_BLACK)
    curses.init_pair(2, curses.COLOR_GREEN, curses.COLOR_BLACK)
    curses.init_pair(3, curses.COLOR_BLUE, curses.COLOR_BLACK)

    stdscr.addstr("SILO LEVEL EDITOR", curses.A_REVERSE)
    stdscr.chgat(-1, curses.A_REVERSE)

    stdscr.addstr(curses.LINES - 1, 0, "Use 'hjkl' to move, 'Q' to quit.")
    stdscr.chgat(curses.LINES - 1, 5, 4, curses.A_BOLD | curses.color_pair(2))
    stdscr.chgat(curses.LINES - 1, 21, 1, curses.A_BOLD | curses.color_pair(1))

    container_window = curses.newwin(curses.LINES - 2, curses.COLS, 1, 0)
    main_window = container_window.subwin(
            WINDOW_HEIGHT, WINDOW_WIDTH, WINDOW_Y, WINDOW_X)
    y, x = (WINDOW_HEIGHT - WINDOW_Y) / 2, (WINDOW_WIDTH - WINDOW_X) / 2
    main_window.addstr(y, x, CURSOR, curses.color_pair(3))
    container_window.box()

    stdscr.noutrefresh()
    container_window.noutrefresh()

    curses.doupdate()

    while True:
        ch = chr(stdscr.getch())

        if ch in 'hjkl':
            main_window.clear()
            dy, dx = {'h': (0, -1), 'j': (1, 0), 'k': (-1, 0), 'l': (0, 1)}[ch]
            y += dy
            x += dx
            main_window.addstr(y, x, CURSOR, curses.color_pair(3))
        elif ch.lower() == 'q':
            break

        # Refresh all windows bottom up to prevent flickering.
        stdscr.noutrefresh()
        container_window.noutrefresh()
        main_window.noutrefresh()
        curses.doupdate()

if __name__ == "__main__":
    curses.wrapper(main)
